<!DOCTYPE html>
<html>

<head><meta name="generator" content="Hexo 3.9.0">
  
    <!-- Google Tag Manager -->
    <script>
      ; (function (w, d, s, l, i) {
        w[l] = w[l] || []
        w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' })
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != 'dataLayer' ? '&l=' + l : ''
        j.async = true
        j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl
        f.parentNode.insertBefore(j, f)
      })(window, document, 'script', 'dataLayer', 'GTM-WJ7P5KL')
    </script>
    <!-- End Google Tag Manager -->

    <script>
      var _hmt = _hmt || []
        ; (function () {
          var hm = document.createElement('script')
          hm.src = 'https://hm.baidu.com/hm.js?5a0acc897fd96474a2c8f4deac84611a'
          var s = document.getElementsByTagName('script')[0]
          s.parentNode.insertBefore(hm, s)
        })()
    </script>
    <!-- ç™¾åº¦ç»Ÿè®¡ -->

    
      <meta charset="utf-8">
      <meta name="baidu-site-verification" content="vvVgSQUzPU">
      <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
      <meta name="keywords" content>
      
        <meta name="google-site-verification" content="VQowHv5lAVVWJxjKI9bnAWT7NGdOrfS5KnLF07-B7w0">
        
          <meta name="description" content>
          <title>
            Hexo - 
          </title>

          <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon">
          <link rel="stylesheet" href="/style/style.css">
            <link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css">
            <script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script>
            <link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css">
            <script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script>
            <script>
              hljs.initHighlightingOnLoad();
            </script>
            <script type="text/javascript" src="https://unpkg.com/minigrid@3.1.1/dist/minigrid.min.js"></script>
            <link rel="stylesheet" href="../source/photos/photos.css">
            <script type="text/javascript" src="../source/photos/photo.js"></script>
</head>

<body>
  <div id="fixed-menu">
    <div class="up">
      <svg class="icon" aria-hidden="true">
        <use xlink:href="#icon-fenzu7"/>
      </svg>
    </div>
  </div>
  <div id="progress">
    <div class="line"></div>
  </div>
  <div id="head">
    
      <a href="/" class>
        Home
      </a>
      
      <a href="/archives" class>
        Archives
      </a>
      
      <a href="/about" class>
        About
      </a>
      
      <a href="/music" class>
        music
      </a>
      
      <a href="/gallery" class>
        gallery
      </a>
      
  </div>
  <div id="container">
    <div id="main">
      <div class="navbar">
        <div class="toggle">
          <svg class="icon toggle-icon" aria-hidden="true">
            <use xlink:href="#icon-fenzu3"/>
          </svg>
        </div>
        <div class="search">
          <div class="input-warp">
            <svg class="icon" aria-hidden="true">
              <use xlink:href="#icon-fenzu"/>
            </svg>
            <input type="text" name id="search" placeholder="Search Keys">
          </div>
        </div>
      </div>
      <div class="content">
        <article class="post-entry">
  <div class="header">
    <div class="title">
      ReactHooks(ä¸€)
    </div>
    
      <div class="meta">
        <span>
          <svg class="icon" aria-hidden="true">
            <use xlink:href="#icon-fenzu4"/>
          </svg>
          2022/04/05
        </span>
        <span>
          <svg class="icon" aria-hidden="true">
            <use xlink:href="#icon-fenzu14"/>
          </svg>
          <span>
            
              
                      
          </span>
        </span>
        <span>
          <svg class="icon" aria-hidden="true">
            <use xlink:href="#icon-fenzu15"/>
          </svg>
          <span>
            
              
                
                  <a href="/tags/React">
                    React
                  </a>
                  
                    
                      
          </span>
        </span>
        <span class="leancloud-visitors" id="https://piggyzss.github.io/2022/04/05/ReactHooks(ä¸€)/" data-flag-title="ReactHooks(ä¸€)">
          <svg class="icon" aria-hidden="true">
            <use xlink:href="#icon-fenzu6"/>
          </svg>
          <span class="leancloud-visitors-count"></span>
        </span>
      </div>
      
        
            <div>
            </div>
  </div>
  <h1 id="1ã€ä»€ä¹ˆæ˜¯hooksä»¥åŠä¸ºä»€ä¹ˆæ˜¯hooksï¼Ÿ"><a href="#1ã€ä»€ä¹ˆæ˜¯hooksä»¥åŠä¸ºä»€ä¹ˆæ˜¯hooksï¼Ÿ" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯hooksä»¥åŠä¸ºä»€ä¹ˆæ˜¯hooksï¼Ÿ"></a>1ã€ä»€ä¹ˆæ˜¯hooksä»¥åŠä¸ºä»€ä¹ˆæ˜¯hooksï¼Ÿ</h1><h3 id="1-1ã€ä»€ä¹ˆæ˜¯hooksï¼Ÿ"><a href="#1-1ã€ä»€ä¹ˆæ˜¯hooksï¼Ÿ" class="headerlink" title="1-1ã€ä»€ä¹ˆæ˜¯hooksï¼Ÿ"></a>1-1ã€ä»€ä¹ˆæ˜¯hooksï¼Ÿ</h3><blockquote>
<p><em>Hook</em> æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§ã€‚å®ƒå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§ã€‚</p>
</blockquote>
<p>Hookæœ¬èº«æ„æ€æ˜¯â€œé’©å­â€ï¼Œä½œç”¨å°±æ˜¯â€œå‹¾ä½æŸäº›ç”Ÿå‘½å‘¨æœŸå‡½æ•°æˆ–æŸäº›æ•°æ®çŠ¶æ€ï¼Œå¹¶è¿›è¡ŒæŸäº›å…³è”è§¦å‘è°ƒç”¨â€ã€‚</p>
<h3 id="1-2ã€ä¸ºä»€ä¹ˆæ˜¯hooks"><a href="#1-2ã€ä¸ºä»€ä¹ˆæ˜¯hooks" class="headerlink" title="1-2ã€ä¸ºä»€ä¹ˆæ˜¯hooks"></a>1-2ã€ä¸ºä»€ä¹ˆæ˜¯hooks</h3><ul>
<li>ç¼ºç‚¹ä¸€ï¼šå¤æ‚ä¸”ä¸å®¹æ˜“ç†è§£çš„â€œthisâ€</li>
</ul>
<p>ä¾‹å¦‚äº‹ä»¶ç»‘å®šå¤„ç†å‡½æ•°ï¼Œéƒ½éœ€è¦bind(this)æ‰å¯ä»¥æ­£ç¡®æ‰§è¡Œï¼›æƒ³è·å–æŸäº›è‡ªå®šä¹‰å±æ€§ï¼Œéƒ½éœ€è¦ä½¿ç”¨this.state.xxæˆ–this.props.xxã€‚</p>
<ul>
<li>ç¼ºç‚¹äºŒï¼šç»„ä»¶æ•°æ®çŠ¶æ€é€»è¾‘ä¸èƒ½é‡ç”¨</li>
</ul>
<p>è¯¦ç»†è§£é‡Šå¦‚ä¸‹ï¼š</p>
<p>â€œç»„ä»¶æ•°æ®çŠ¶æ€â€æ˜¯ç”±ï¼šå®šä¹‰æ•°æ®ã€é»˜è®¤èµ‹å€¼ã€è·å–æ•°æ®ã€ä¿®æ”¹æ•°æ®ã€æ•°æ®é€»è¾‘å‡ ä¸ªç¯èŠ‚æ„æˆã€‚ ç”±äºç±»ç»„ä»¶ä¸­çš„ç»„ä»¶æ•°æ®çŠ¶æ€stateå¿…é¡»å†™åœ¨è¯¥ç»„ä»¶æ„é€ å‡½æ•°å†…éƒ¨ï¼Œæ— æ³•å°†stateæŠ½ç¦»å‡ºç»„ä»¶ï¼Œå› æ­¤åˆ«çš„ç»„ä»¶å¦‚æœæœ‰ç±»ä¼¼stateé€»è¾‘ï¼Œä¹Ÿå¿…é¡»å†…éƒ¨è‡ªå·±å®ç°ä¸€æ¬¡ï¼Œæ‰€ä»¥æ‰å¾—å‡ºâ€œç»„ä»¶æ•°æ®çŠ¶æ€é€»è¾‘ä¸èƒ½é‡ç”¨â€çš„ç»“è®ºã€‚</p>
<p><strong>é€šè¿‡è‡ªå®šä¹‰hookï¼Œå¯ä»¥æ•°æ®çŠ¶æ€é€»è¾‘ä»ç»„ä»¶ä¸­æŠ½ç¦»å‡ºå»ï¼ˆä¹Ÿå°±æ˜¯å…¬å…±å¯å¤ç”¨çš„hookï¼‰ï¼Œè¿™æ ·åŒä¸€ä¸ªhookå¯ä»¥è¢«å¤šä¸ªç»„ä»¶ä½¿ç”¨ï¼Œè§£å†³ç»„ä»¶æ•°æ®çŠ¶æ€é€»è¾‘å¹¶ä¸èƒ½é‡ç”¨çš„é—®é¢˜ã€‚</strong></p>
<h3 id="1-3ã€ã€æ³¨æ„ã€‘"><a href="#1-3ã€ã€æ³¨æ„ã€‘" class="headerlink" title="1-3ã€ã€æ³¨æ„ã€‘"></a>1-3ã€ã€æ³¨æ„ã€‘</h3><p>ä½¿ç”¨hooksçš„è¿‡ç¨‹ä¸­ï¼Œä»¥ä¸‹å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li>Hooksåªèƒ½è¿è¡Œåœ¨å‡½æ•°ç»„ä»¶ä¸­ï¼Œä¸èƒ½è¿è¡Œåœ¨ç±»ç»„ä»¶ä¸­</li>
</ul>
<p>å‡†ç¡®æ¥è¯´ï¼ŒHooksåªèƒ½è¿è¡Œåœ¨å‡½æ•°ç»„ä»¶çš„â€œå†…éƒ¨é¡¶å±‚ä¸­â€ï¼Œ<strong>ä¸èƒ½è¿è¡Œåœ¨if/forç­‰å…¶ä»–å‡½æ•°çš„ä»£ç ä½“å†…ï¼Œä¸å…è®¸è¢«if/forç­‰åŒ…è£¹ä½ã€‚</strong></p>
<ul>
<li>Hookså‡½æ•°å¿…é¡»ä¸ºçº¯å‡½æ•°</li>
</ul>
<p>æ‰€è°“çº¯å‡½æ•°å°±æ˜¯å‡½æ•°å†…éƒ¨ä¸èƒ½ä¿®æ”¹å¯èƒ½å½±å“æ‰§è¡Œç»“æœçš„ä»»æ„å‚æ•°ï¼Œç¡®ä¿æ¯æ¬¡æ‰§è¡Œçš„ä»£ç ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
<ul>
<li>å¯ä»¥ä»è‡ªå®šä¹‰ Hooks ä¸­è°ƒç”¨ Hooksï¼›è‡ªå®šä¹‰ Hooks å¿…é¡»ä½¿ç”¨ use å¼€å¤´ï¼Œè¿™æ˜¯ä¸€ç§çº¦å®šã€‚</li>
</ul>
<h1 id="2ã€useState"><a href="#2ã€useState" class="headerlink" title="2ã€useState"></a>2ã€useState</h1><p>useStateçš„ä½œç”¨æ˜¯â€œå‹¾ä½â€å‡½æ•°ç»„ä»¶ä¸­è‡ªå®šä¹‰çš„å˜é‡</p>
<p><code>const [variable,  ``setVariable``] = useState(initialState)</code></p>
<h3 id="2-1ã€å…¥å‚"><a href="#2-1ã€å…¥å‚" class="headerlink" title="2-1ã€å…¥å‚"></a>2-1ã€å…¥å‚</h3><p>å…¥å‚å¯ä»¥æ˜¯è¯¥stateçš„åˆå§‹å€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥é€šè¿‡é€»è¾‘è®¡ç®—å‡ºé»˜è®¤å€¼</p>
<p>ã€æƒ°æ€§ initialStateã€‘</p>
<p>å¦‚æœè®¡ç®—çš„ä»£ä»·æ¯”è¾ƒæ˜‚è´µï¼Œå¯ä»¥ä¼ ä¸€ä¸ªå‡½æ•°ç»™ useStateï¼Œåœ¨å‡½æ•°ä¸­è®¡ç®—å¹¶è¿”å› initialStateï¼Œæ­¤å‡½æ•°åªä¼šåœ¨åˆå§‹æ¸²æŸ“æ—¶è¢«è°ƒç”¨ä¸€æ¬¡ï¼Œåç»­é‡æ–°æ¸²æŸ“æ—¶ä¼šè¢«å¿½ç•¥ã€‚</p>
<h3 id="2-2ã€å‡½æ•°å¼æ›´æ–°"><a href="#2-2ã€å‡½æ•°å¼æ›´æ–°" class="headerlink" title="2-2ã€å‡½æ•°å¼æ›´æ–°"></a>2-2ã€å‡½æ•°å¼æ›´æ–°</h3><p>å¦‚æœæ–°çš„ state éœ€è¦é€šè¿‡ä½¿ç”¨å…ˆå‰çš„ state è®¡ç®—å¾—å‡ºï¼Œé‚£ä¹ˆå¯ä»¥å°†å›è°ƒå‡½æ•°å½“ä½œå‚æ•°ä¼ é€’ç»™ setStateã€‚è¯¥å›è°ƒå‡½æ•°å°†æ¥æ”¶å…ˆå‰çš„ stateï¼Œå¹¶è¿”å›ä¸€ä¸ªæ›´æ–°åçš„å€¼ã€‚</p>
<ul>
<li><code>setCount(prevData =&gt; prevData+1)</code></li>
</ul>
<p>å¸¸ç”¨äºè§£å†³æ•°æ®å¼‚æ­¥é—®é¢˜</p>
<p>æ­¤å¤„åº”è¯¥æœ‰ä¸ªğŸŒ°ï¼šå·ä¸ªæ‡’ï¼Œå›å¤´å†è¡¥å—·</p>
<h3 id="2-3ã€æ›´æ–°ï¼šæ›¿æ¢éåˆå¹¶"><a href="#2-3ã€æ›´æ–°ï¼šæ›¿æ¢éåˆå¹¶" class="headerlink" title="2-3ã€æ›´æ–°ï¼šæ›¿æ¢éåˆå¹¶"></a>2-3ã€æ›´æ–°ï¼šæ›¿æ¢éåˆå¹¶</h3><p>åœ¨ç±»ç»„ä»¶ä¸­ï¼ŒsetStateæ˜¯æ‰§è¡Œçš„æ˜¯â€œå¼‚æ­¥å¯¹æ¯”ç´¯åŠ èµ‹å€¼â€ï¼Œä½•ä¸ºâ€œå¯¹æ¯”â€ï¼Ÿ å°±æ˜¯å…ˆå¯¹æ¯”ä¹‹å‰æ•°æ®å±æ€§ä¸­æ˜¯å¦æœ‰ageï¼Œå¦‚æœæœ‰åˆ™ä¿®æ”¹ageå€¼ï¼ŒåŒæ—¶ä¸ä¼šå½±å“åˆ°å…¶ä»–å±æ€§çš„å€¼ã€‚</p>
<p>ä½†æ˜¯ï¼Œç”¨useStateå®šä¹‰çš„ä¿®æ”¹å‡½æ•° setXxxxï¼Œæ‰§è¡Œçš„æ˜¯ â€œå¼‚æ­¥ç›´æ¥èµ‹å€¼â€ã€‚</p>
<p>å› æ­¤è‹¥stateä¸ºå¯¹è±¡æˆ–æ•°ç»„æ—¶ï¼Œåœ¨è°ƒç”¨setStateæ—¶éœ€è¦æ‹·è´ä¸€ä»½ï¼Œç„¶åä¿®æ”¹åè¿›è¡Œèµ‹å€¼</p>
<h3 id="2-4ã€æ€§èƒ½é—®é¢˜"><a href="#2-4ã€æ€§èƒ½é—®é¢˜" class="headerlink" title="2-4ã€æ€§èƒ½é—®é¢˜"></a>2-4ã€æ€§èƒ½é—®é¢˜</h3><p>æˆ‘æ›¾ç»å¥½å¥‡è¿‡ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœé€šè¿‡setStateè®¾ç½®ï¼Œä½†æ˜¯nextValueå’ŒpreValueå®Œå…¨ä¸€æ ·ï¼Œé‚£ä¹ˆä¼šå¼•å‘Reactçš„rerenderå—ï¼Ÿ</p>
<p>ç›´æ¥ä¸Šç»“è®ºï¼š</p>
<ul>
<li>ç®€å•ç±»å‹ï¼šå¦‚Stringã€Numberç­‰ï¼Œæ–°æ—§å€¼ä¸€æ ·çš„æƒ…å†µä¸‹ä¸ä¼šå¼•èµ·é‡æ–°æ¸²æŸ“</li>
</ul>
<!---->

<ul>
<li>å¤æ‚ç±»å‹ï¼šå³ä½¿æ–°æ—§å€¼ â€œçœ‹ä¸Šå»æ˜¯ä¸€æ ·çš„â€ ä¹Ÿä¼šå¼•èµ·é‡æ–°æ¸²æŸ“ã€‚é™¤éæ–°æ—§å€¼æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œæˆ–è€…è¯´æ–°æ—§å€¼æ˜¯åŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨æ—¶ï¼Œæ‰ä¸ä¼šé‡æ–°æ¸²æŸ“</li>
</ul>
<p>ã€å¼•ç”³ã€‘é‚£ä¹ˆåº”è¯¥ä½¿ç”¨å•ä¸ªè¿˜æ˜¯å¤šä¸ª state å˜é‡ï¼Ÿ</p>
<p>å®˜æ–¹å‚è€ƒï¼š<a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#should-i-use-one-or-many-state-variables" target="_blank" rel="noopener">https://zh-hans.reactjs.org/docs/hooks-faq.html#should-i-use-one-or-many-state-variables</a></p>
<h1 id="3ã€useEffect"><a href="#3ã€useEffect" class="headerlink" title="3ã€useEffect"></a>3ã€useEffect</h1><p>useEffectçš„ä½œç”¨æ˜¯â€œå‹¾ä½â€å‡½æ•°ç»„ä»¶ä¸­æŸäº›ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚</p>
<p>è¿™äº›ç”Ÿå‘½å‘¨æœŸå‡½æ•°åŒ…æ‹¬ï¼šcomponentDidMount(ç»„ä»¶è¢«æŒ‚è½½å®Œæˆå)ã€componentDidUpdate(ç»„ä»¶é‡æ–°æ¸²æŸ“å®Œæˆå)ã€componentWillUnmount(ç»„ä»¶å³å°†è¢«å¸è½½å‰)</p>
<p><code>useEffect(() =&gt; { doSomething }, []])</code></p>
<h3 id="3-1ã€å…¥å‚"><a href="#3-1ã€å…¥å‚" class="headerlink" title="3-1ã€å…¥å‚"></a>3-1ã€å…¥å‚</h3><p><strong>ã€ç¬¬ä¸€ä¸ªå…¥å‚ã€‘</strong> å‡½æ•°</p>
<p>å®ƒæ˜¯åœ¨ç¬¬ä¸€æ¬¡æŒ‚è½½å®Œæˆä»¥åŠä¹‹åæ›´æ–°æ¸²æŸ“åä¼šæ‰§è¡Œçš„ä»£ç å—ã€‚</p>
<p><strong>è¿™ä¸ªå‡½æ•°å¯èƒ½ä¼šæœ‰è¿”å›å€¼ï¼Œå€˜è‹¥æœ‰è¿”å›å€¼ï¼Œè¿”å›å€¼ä¹Ÿå¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼šåœ¨ç»„ä»¶è¢«é”€æ¯æ—¶æ‰§è¡Œã€‚</strong></p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="javascript">useEffect(() =&gt; { 
  //æ­¤å¤„ä¸º ç»„ä»¶æŒ‚è½½ä¹‹åå’Œç»„ä»¶é‡æ–°æ¸²æŸ“ä¹‹åæ‰§è¡Œçš„éƒ¨åˆ†
  window.addEventListener(&#39;click&#39;, handleClick)
  return () =&gt; {
    //æ­¤å¤„ä¸º ç»„ä»¶å³å°†è¢«å¸è½½å‰æ‰§è¡Œçš„éƒ¨åˆ†
    window.addEventListener(&#39;click&#39;, handleClick)
  }
})</code></pre>
<p><strong>ã€ç¬¬äºŒä¸ªå…¥å‚ã€‘</strong></p>
<ul>
<li>ä»€ä¹ˆéƒ½ä¸ä¼ ï¼Œç»„ä»¶æ¯æ¬¡ render ä¹‹å useEffect éƒ½ä¼šè°ƒç”¨ï¼Œç›¸å½“äº componentDidMount å’Œ componentDidUpdate</li>
</ul>
<!---->

<ul>
<li>ä¼ å…¥ä¸€ä¸ªç©ºæ•°ç»„ []ï¼Œåªä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œç›¸å½“äº componentDidMount å’Œ componentWillUnmount</li>
</ul>
<!---->

<ul>
<li>ä¼ å…¥ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­åŒ…æ‹¬å„ç§ä¾èµ–å˜é‡ï¼Œåªæœ‰è¿™äº›å˜é‡å˜åŠ¨æ—¶ï¼ŒuseEffect æ‰ä¼šæ‰§è¡Œ</li>
</ul>
<h3 id="3-2ã€é—­åŒ…é—®é¢˜"><a href="#3-2ã€é—­åŒ…é—®é¢˜" class="headerlink" title="3-2ã€é—­åŒ…é—®é¢˜"></a>3-2ã€é—­åŒ…é—®é¢˜</h3><p>å…ˆçœ‹ä¸€ä¸ªæ —å­ï¼š</p>
<pre><code class="javascript">import React, { useState, useEffect } from &#39;react&#39;

const App = () =&gt; {
  const [number, setNumber] = useState(0) //å®šä¹‰å˜é‡aï¼Œå¹¶ä¸”é»˜è®¤å€¼ä¸º0

  //å®šä¹‰ä¸€ä¸ªuseEffectï¼Œç”¨äºå¤„ç†ç´¯åŠ å™¨
  useEffect(() =&gt; {
    let timer = setInterval(() =&gt; { setNumber(number + 1) }, 1000)
    return () =&gt; {
      clearInterval(timer);
    }
  }, [])

  useEffect(() =&gt; {
    console.log(&#39;update enter&#39;)
  }, [number])

  return &lt;div&gt; {number} &lt;/div&gt;
}

export default App</code></pre>
<p>ä¿¡å¿ƒæ»¡æ»¡çš„æ‰§è¡Œä¸€ä¸‹ï¼Œå‘ç°ç»“æœå¹¶ä¸ç¬¦åˆé¢„æœŸï¼</p>
<p>é—®é¢˜å‡ºåœ¨å“ªå„¿å‘¢ï¼Ÿ</p>
<p>æ‰“å¼€æ§åˆ¶å°ï¼Œä¼šå‘ç°æœ‰å¦‚ä¸‹æŠ¥é”™ï¼š<code>React``  Hook useEffect has a missing dependency: &#39;number&#39;. Either include it or remove the dependency array. You can also do a functional update &#39;setNumber(n =&gt; ...)&#39; if you only need &#39;number&#39; in the &#39;setNumber&#39; call</code></p>
<p>è¿™ä¸ªæç¤ºå·²ç»å‘Šè¯‰æˆ‘ä»¬è¦æ€æ ·ä¿®æ”¹äº†ï¼Œå…¶å®å°±æ˜¯ä¸Šä¸€èŠ‚è¯´åˆ°çš„ç”¨äºè§£å†³å¼‚æ­¥é—®é¢˜çš„å‡½æ•°å¼æ›´æ–°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å’”å’”ä¸€å’”å’”æ“ä½œä¸€ç•ªï¼Œä¿®æ”¹æˆè¿™æ ·ï¼š</p>
<pre><code class="javascript">***
  useEffect(() =&gt; {
    let timer = setInterval(() =&gt; { setNumber(number =&gt; number + 1) }, 1000)
    return () =&gt; {
      clearInterval(timer);
    }
  }, [])
***</code></pre>
<p>runä¸€ä¸‹ï¼Œå‘ç°æ²¡æœ‰é—®é¢˜äº†ï¼Œå®Œç¾ï½</p>
<p>ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p>
<p>ç­”ï¼šå¦‚æœuseEffectç¬¬2ä¸ªå‚æ•°ä¸ºç©ºæ•°ç»„ï¼Œé‚£ä¹ˆreactä¼šä¸ºè¯¥useEffectçš„ç¬¬1ä¸ªå‚æ•°å»ºç«‹ä¸€ä¸ªé—­åŒ…ï¼Œè¯¥é—­åŒ…é‡Œçš„å˜é‡<code>number</code>è¢«æ°¸è¿œè®¾å®šä¸ºå½“åˆçš„å€¼ï¼Œå³ 0ã€‚å°½ç®¡<code>setInterval</code>æ­£å¸¸å·¥ä½œï¼Œæ¯æ¬¡éƒ½â€œæ­£å¸¸æ‰§è¡Œäº†â€ï¼Œå¯æ˜¯ <code>setNumber(number+1)</code>ä¸­ <code>number</code>çš„å€¼ä¸€ç›´æ²¡å˜åŒ–ï¼Œä¸€ç›´éƒ½æ˜¯å½“åˆçš„0ï¼Œæ‰€ä»¥ä¼šå‡ºç° 0 + 1 ä¸€ç›´éƒ½ç­‰äº 1 çš„ç»“æœã€‚</p>
<p>è€Œå¦‚æœä¿®æ”¹æˆ<code>setNumber(number =&gt; number + 1)</code>çš„å½¢å¼ï¼Œé‚£ä¹ˆå°±è§£å†³äº†æ•°æ®å¼‚æ­¥çš„é—®é¢˜ï¼Œæ¯æ¬¡éƒ½æ˜¯è¯»å–æœ€æ–°å½“å‰<code>number</code>çš„å€¼ã€‚</p>
<p>å®˜æ–¹å‚è€ƒï¼š<a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#what-can-i-do-if-my-effect-dependencies-change-too-often" target="_blank" rel="noopener">https://zh-hans.reactjs.org/docs/hooks-faq.html#what-can-i-do-if-my-effect-dependencies-change-too-often</a></p>
<h1 id="4ã€useContext"><a href="#4ã€useContext" class="headerlink" title="4ã€useContext"></a>4ã€useContext</h1><p>useContextçš„ä½œç”¨æ˜¯â€œå‹¾ä½â€è·å–ç”±<code>React.createContext()</code>åˆ›å»ºã€<code>&lt;XXX.Provider&gt;</code>æ·»åŠ è®¾ç½®çš„å…±äº«æ•°æ®ã€‚</p>
<p>åŸæœ¬ä¸åŒçº§åˆ«çš„ç»„ä»¶ä¹‹é—´ä¼ é€’propså¿…é¡»é€å±‚ä¼ é€’ï¼Œå³ä¾¿ä¸­é—´å±‚çš„ç»„ä»¶ä¸éœ€è¦è¿™äº›æ•°æ®ã€‚æ•°æ®å±‚å±‚ä¼ é€’å¢åŠ äº†ç»„ä»¶çš„å¤æ‚æ€§ï¼Œé™ä½äº†å¯å¤ç”¨æ€§ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡contextçš„æ–¹å¼ï¼Œåœ¨ç»„ä»¶é¡¶å±‚æˆ–å•ç‹¬çš„æ¨¡å—ä¸­åˆ›å»ºä¸€ä¸ªå…±äº«æ•°æ®å¯¹è±¡ï¼Œè¿™æ ·åœ¨ä»»æ„ä¸€ä¸ªéœ€è¦å…±äº«æ•°æ®çš„å­ç»„ä»¶ä¸­å»è·å–å³å¯ï¼Œé¿å…äº†æ•°æ®çš„å±‚å±‚ä¼ é€’ã€‚</p>
<p><code>useContext</code>æ˜¯<code>&lt;XXX.Consumer&gt;</code>çš„æ›¿ä»£å“ï¼Œå¯ä»¥ç®€åŒ–è·å–å…±äº«æ•°æ®å€¼ã€‚</p>
<p>å®˜æ–¹æ —å­ï¼š<br>App.js</p>
<pre><code class="javascript">export const GlobalContext = React.createContext()
export default () =&gt; { 
  return (
    &lt;GlobalContext.Provider value={{name:'miaomiao', age:1}}&gt;
        &lt;MiddleComponent /&gt;
    &lt;/GlobalContext.Provider&gt;
  ) 
}</code></pre>
<p>Example.js</p>
<pre><code class="javascript">import { GlobalContext } from &#39;./App&#39;
// ä¸ä½¿ç”¨hooks
class Example extends PureComponent { 
  return &lt;GlobalContext.Consumer&gt;
    {
        global =&gt; {
            return &lt;div&gt;{global.name} - {global.age}&lt;/div&gt;
        }
    }
  &lt;/GlobalContext.Consumer&gt;
}

// ä½¿ç”¨hooks
export default () =&gt; { 
  const context = useContext(ThemeContext)
  return (
      &lt;div&gt;
        {context.name} - {context.age}
      &lt;/div&gt;
  )
}</code></pre>
<h1 id="5ã€useMemo"><a href="#5ã€useMemo" class="headerlink" title="5ã€useMemo"></a>5ã€useMemo</h1><p><code>useMemo</code>çš„ä½œç”¨æ˜¯â€œå‹¾ä½â€ç»„ä»¶ä¸­æŸäº›å¤„ç†å‡½æ•°çš„è¿”å›å€¼ï¼Œå½“ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ï¼Œå¦‚æœuseMemoä¾èµ–çš„æ•°æ®å˜é‡æœªå‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆç›´æ¥ä½¿ç”¨åŸå‹é“¾ä¸Šä¿å­˜çš„è¯¥å‡½æ•°è®¡ç®—ç»“æœï¼Œé¿å…åœ¨æ¯ä¸ªæ¸²æŸ“ä¸Šè¿›è¡Œæ˜‚è´µçš„è®¡ç®—ï¼Œè¾¾åˆ°æé«˜ç»„ä»¶æ€§èƒ½çš„ç›®çš„ã€‚</p>
<h3 id="5-1ã€å…¥å‚"><a href="#5-1ã€å…¥å‚" class="headerlink" title="5-1ã€å…¥å‚"></a>5-1ã€å…¥å‚</h3><p><strong>ã€ç¬¬ä¸€ä¸ªå…¥å‚ã€‘</strong> å‡½æ•°ï¼šåŒ…å«å¤æ‚è®¡ç®—ä¸”æœ‰è¿”å›å€¼çš„å‡½æ•°</p>
<p><strong>ã€ç¬¬äºŒä¸ªå…¥å‚ã€‘</strong> ä¾èµ–é¡¹æ•°ç»„</p>
<p>æ —å­</p>
<pre><code class="javascript">import React, { useState, useMemo } from &#39;react&#39;

const App = () =&gt; {
  const [number, setNumber] = useState(0)
  const [name, setName] = useState(&#39;&#39;)

  const data = useMemo(() =&gt; {
    console.log(&#39;enter&#39;)
    // å®é™…ä»£ç ä¸­è¿™é‡Œæ˜¯ä¸€ç³»åˆ—å¤æ‚çš„è¿ç®—è¿‡ç¨‹
    return number * number
  }, [number])

  return (
    &lt;&gt;
      &lt;div&gt; {number} {data} &lt;/div&gt;
      &lt;button onClick={() =&gt; setNumber(number + 1)}&gt;add number&lt;/button&gt;
      &lt;div&gt; {name} &lt;/div&gt;
      &lt;button onClick={() =&gt; setName(name + &#39;_temp&#39;)}&gt;change name&lt;/button&gt;
    &lt;/&gt;
  )
}

export default App</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå½“nameå˜åŒ–çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šè§¦å‘dataçš„å˜åŒ–</p>
<h1 id="6ã€useCallback"><a href="#6ã€useCallback" class="headerlink" title="6ã€useCallback"></a>6ã€useCallback</h1><p>useCallbackçš„ä½œç”¨æ˜¯â€œå‹¾ä½â€ç»„ä»¶å±æ€§ä¸­æŸäº›å¤„ç†å‡½æ•°ï¼Œåªæœ‰å½“ä¾èµ–å˜é‡å‘ç”Ÿæ”¹å˜æ—¶æ‰ä¼šé‡æ–°ä¿®æ”¹å¹¶åˆ›å»ºæ–°çš„ä¸€ä»½å¤„ç†å‡½æ•°ã€‚</p>
<h3 id="6-1ã€å…¥å‚"><a href="#6-1ã€å…¥å‚" class="headerlink" title="6-1ã€å…¥å‚"></a>6-1ã€å…¥å‚</h3><p><strong>ã€ç¬¬ä¸€ä¸ªå…¥å‚ã€‘</strong> å‡½æ•°ï¼šå†…è”å›è°ƒå¤„ç†å‡½æ•°</p>
<p><strong>ã€ç¬¬äºŒä¸ªå…¥å‚ã€‘</strong> ä¾èµ–é¡¹æ•°ç»„</p>
<h3 id="6-2ã€ä¸€äº›èƒŒæ™¯å°çŸ¥è¯†"><a href="#6-2ã€ä¸€äº›èƒŒæ™¯å°çŸ¥è¯†" class="headerlink" title="6-2ã€ä¸€äº›èƒŒæ™¯å°çŸ¥è¯†"></a>6-2ã€ä¸€äº›èƒŒæ™¯å°çŸ¥è¯†</h3><h4 id="React-memo"><a href="#React-memo" class="headerlink" title="React.memo()"></a>React.memo()</h4><p>æˆ‘ä»¬çŸ¥é“å¦‚æœçˆ¶ç»„ä»¶reRenderï¼Œé‚£ä¹ˆè¯¥çˆ¶ç»„ä»¶ä¸‹çš„æ‰€æœ‰å­ç»„ä»¶éƒ½ä¼šéšç€çˆ¶çº§çš„reRenderè€ŒreRenderã€‚</p>
<ul>
<li>æ— è®ºå­ç»„ä»¶æ˜¯ç±»ç»„ä»¶æˆ–æ˜¯å‡½æ•°ç»„ä»¶</li>
</ul>
<!---->

<ul>
<li>æ— è®ºå­ç»„ä»¶åœ¨æœ¬æ¬¡æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œå­ç»„ä»¶æ˜¯å¦æœ‰ä»»ä½•ç›¸å…³çš„ä¾èµ–æ•°æ®å˜åŒ–</li>
</ul>
<p>å‡è®¾æŸçˆ¶ç»„ä»¶ä¸­æœ‰2ä¸ªå­ç»„ä»¶ï¼šå­ç»„ä»¶C1ã€å­ç»„ä»¶C2ã€‚è‹¥å› ä¸ºå­ç»„ä»¶C1å‘ç”Ÿäº†æŸäº›æ“ä½œï¼Œå¼•å‘çˆ¶ç»„ä»¶reRenderï¼Œè¿™æ—¶å³ä¾¿å­ç»„ä»¶C2æ²¡æœ‰ä»»ä½•éœ€è¦æ›´æ”¹çš„åœ°æ–¹ï¼Œä¹Ÿä¼šé‡æ–°è¢«æ¸²æŸ“ä¸€æ¬¡ã€‚</p>
<p>å¯¹äºæ¸²æŸ“æˆæœ¬è¾ƒå¤§çš„ç»„ä»¶ï¼Œè¿™æ ·çš„reRenderæ˜¾ç„¶ä¸ç¬¦åˆé¢„æœŸï¼Œreactç»™å‡ºçš„æ–¹æ¡ˆæ˜¯<code>React.PureComponent</code>ï¼Œ<code>React.PureComponent</code>é»˜è®¤ä¼šå¸®æˆ‘ä»¬å®Œæˆpropså’Œstateçš„æµ…å±‚å¯¹æ¯”ï¼Œç”¨ä»¥åˆ¤æ–­æ˜¯å¦éœ€è¦è·³è¿‡æœ¬æ¬¡reRenderã€‚</p>
<p><code>React.PureComponent</code>æ˜¯é’ˆå¯¹ç±»ç»„ä»¶æå‡ºçš„ï¼Œå‡½æ•°ç»„ä»¶ä¸­ä¸ä¹‹å¯¹åº”çš„æ˜¯<code>React.memo()</code>ï¼Œä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p>
<pre><code class="javascript">import React from &#39;react&#39;
function C2() {
  return &lt;div&gt;xx&lt;/div&gt;;
}
export default React.memo(C2); //ä½¿ç”¨React.memoåŒ…è£¹ä½è¦å¯¼å‡ºçš„å‡½æ•°ç»„ä»¶</code></pre>
<p>è¿™æ ·ç»„ä»¶C2åˆ™ä¸ä¼šå› ä¸ºçˆ¶ç»„ä»¶reRenderè€Œå¼•å‘ä¸å¿…è¦çš„reRenderäº†ã€‚</p>
<h3 id="6-3ã€ä»€ä¹ˆåœºæ™¯ä¸‹éœ€è¦ä½¿ç”¨useCallback"><a href="#6-3ã€ä»€ä¹ˆåœºæ™¯ä¸‹éœ€è¦ä½¿ç”¨useCallback" class="headerlink" title="6-3ã€ä»€ä¹ˆåœºæ™¯ä¸‹éœ€è¦ä½¿ç”¨useCallback"></a>6-3ã€ä»€ä¹ˆåœºæ™¯ä¸‹éœ€è¦ä½¿ç”¨useCallback</h3><p><code>useCallback</code>æ˜¯é€šè¿‡è·å–å‡½æ•°åœ¨reactåŸå‹é“¾ä¸Šçš„å¼•ç”¨ï¼Œå½“å³å°†é‡æ–°æ¸²æŸ“æ—¶ï¼Œç”¨æ—§å€¼çš„å¼•ç”¨å»æ›¿æ¢æ—§å€¼ï¼Œé…åˆ<code>React.memo</code>ï¼Œè¾¾åˆ°â€œé˜»æ­¢ç»„ä»¶ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“â€ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯<code>useCallback</code>å¯ä»¥å°†ç»„ä»¶çš„æŸäº›å¤„ç†å‡½æ•°æŒ‚è½½åˆ°reactåº•å±‚åŸå‹é“¾ä¸Šï¼Œå¹¶è¿”å›è¯¥å¤„ç†å‡½æ•°çš„å¼•ç”¨ï¼Œå½“ç»„ä»¶æ¯æ¬¡å³å°†è¦é‡æ–°æ¸²æŸ“æ—¶ï¼Œç¡®ä¿propsä¸­è¯¥å¤„ç†å‡½æ•°ä¸ºåŒä¸€å‡½æ•°(å› ä¸ºæ˜¯åŒä¸€å¯¹è±¡å¼•ç”¨ï¼Œæ‰€ä»¥===è¿ç®—ç»“æœä¸€å®šä¸ºtrue)ï¼Œè·³è¿‡æœ¬æ¬¡æ— æ„ä¹‰çš„é‡æ–°æ¸²æŸ“ï¼Œè¾¾åˆ°æé«˜ç»„ä»¶æ€§èƒ½çš„ç›®çš„ã€‚å½“ç„¶å‰ææ˜¯è¯¥ç»„ä»¶åœ¨å¯¼å‡ºæ—¶ä½¿ç”¨äº†<code>React.memo()</code>ã€‚</p>
<p>æ —å­ï¼š</p>
<p>ä¸ä½¿ç”¨useCallback</p>
<pre><code class="javascript">Container.jsx
import React, { useState, useCallback } from &#39;react&#39;

import C1 from &#39;./C1&#39;
import C2 from &#39;./C2&#39;

const Container = () =&gt; {
  const [number, setNumber] = useState(0)
  const [name, setName] = useState(&#39;&#39;)

  const handleClick1 = () =&gt; {
    setNumber(number + 1)
  }

  const handleClick2 = () =&gt; {
    setName(name + &#39;_temp&#39;)
  }

  return (
    &lt;&gt;
      &lt;div&gt; {number} {name} &lt;/div&gt;
      &lt;C1 onClick={handleClick1} /&gt;
      &lt;C2 onClick={handleClick2} /&gt;
    &lt;/&gt;
  )
}

export default Container

C1.jsx
import React, { useEffect } from &#39;react&#39;

const C1 = (props) =&gt; {
  const { onClick } = props
  useEffect(() =&gt; {
    console.log(&#39;enter 1&#39;)
  })

  return (
    &lt;div onClick={onClick}&gt;
      app1
    &lt;/div&gt;
  )
}

export default C1

C2.jsx
import React, { useEffect } from &#39;react&#39;

const C2 = (props) =&gt; {
  const { onClick } = props
  useEffect(() =&gt; {
    console.log(&#39;enter 2&#39;)
  })

  return (
    &lt;div onClick={onClick}&gt;
      app2
    &lt;/div&gt;
  )
}

export default C2</code></pre>
<p>æˆ‘ä»¬åœ¨ç‚¹å‡»C1æ—¶ï¼Œè§¦å‘handleClick1å†…çš„æ‰§è¡Œå‡½æ•°ï¼Œå¯¼è‡´Containerç»„ä»¶å†…éƒ¨è‡ªå®šä¹‰çš„å˜é‡numberå˜åŒ–ï¼Œä»è€Œå¼•èµ·Containerçš„reRenderï¼›è€Œæ­¤æ—¶ç”±äºhandleClick2å‡½æ•°æœªåšä»»ä½•å¤„ç†ï¼Œä¼šå¯¼è‡´handleClick2è¢«é‡æ–°èµ‹å€¼ä¸€æ¬¡ï¼ˆè™½ç„¶çœ‹ä¸Šå»å†…å®¹ä¸€æ ·ï¼Œä½†å®é™…ä¸Šå¼•ç”¨å·²ç»ä¸ä¸€æ ·äº†ï¼‰ï¼ŒhandleClick2çš„å˜åŒ–åˆä¼šå¯¼è‡´C2ç»„ä»¶reRenderï¼Œä»è€Œå¼•èµ·ä¸å¿…è¦çš„ç»„ä»¶é‡æ¸²æŸ“ã€‚</p>
<p>æˆ‘ä»¬åˆ©ç”¨<code>useCallback</code>æ”¹é€ ä¸€ä¸‹ä¸Šé¢çš„ä»£ç ï¼š</p>
<pre><code class="javascript">Container.jsx
import React, { useState, useCallback } from &#39;react&#39;

import C1 from &#39;./C1&#39;
import C2 from &#39;./C2&#39;

const Container = () =&gt; {
  const [number, setNumber] = useState(0)
  const [name, setName] = useState(&#39;&#39;)

  const handleClick1 = useCallback(() =&gt; {
    setNumber(number + 1)
  }, [number])

  const handleClick2 = useCallback(() =&gt; {
    setName(name + &#39;_temp&#39;)
  }, [name])

  return (
    &lt;&gt;
      &lt;div&gt; {number} {name} &lt;/div&gt;
      &lt;C1 onClick={handleClick1} /&gt;
      &lt;C2 onClick={handleClick2} /&gt;
    &lt;/&gt;
  )
}

export default Container

C1.jsx
import React, { useEffect } from &#39;react&#39;

const C1 = (props) =&gt; {
  const { onClick } = props
  useEffect(() =&gt; {
    console.log(&#39;enter 1&#39;)
  })

  return (
    &lt;div onClick={onClick}&gt;
      app1
    &lt;/div&gt;
  )
}

export default React.memo(C1)

C2.jsx
import React, { useEffect } from &#39;react&#39;

const C2 = (props) =&gt; {
  const { onClick } = props
  useEffect(() =&gt; {
    console.log(&#39;enter 2&#39;)
  })

  return (
    &lt;div onClick={onClick}&gt;
      app2
    &lt;/div&gt;
  )
}

export default React.memo(C2)</code></pre>
<p>å†è¯•ä¸€ä¸‹ï¼Œå‘ç°C1çš„reRenderä¸ä¼šå†å¼•èµ·C2çš„reRenderäº†ã€‚</p>
<p>æ€»ç»“ï¼š</p>
<ul>
<li>åªæœ‰çˆ¶ç»„ä»¶åŒæ—¶æœ‰å¤šä¸ªå­ç»„ä»¶æ—¶ï¼Œæ‰æœ‰å¿…è¦ç”¨useCallbackå»åšæ€§èƒ½ä¼˜åŒ–ï¼Œé˜²æ­¢æŸä¸€ä¸ªå­ç»„ä»¶å¼•å‘çš„é‡æ–°æ¸²æŸ“ä¹Ÿå¯¼è‡´å…¶ä»–å­ç»„ä»¶è·Ÿç€é‡æ–°æ¸²æŸ“</li>
</ul>
<!---->

<ul>
<li>useCallbackå¯ä»¥ä¿è¯ï¼Œåªè¦åœ¨ä¾èµ–é¡¹æ•°ç»„ä¸å˜çš„æƒ…å†µä¸‹ï¼Œæ— è®º render å¤šå°‘æ¬¡ï¼Œå‡½æ•°éƒ½æ˜¯åŒä¸€ä¸ªå‡½æ•°ï¼Œä»è€Œå‡å°‘å¼€é”€</li>
</ul>
<h3 id="6-4ã€useCallbackçš„æ»¥ç”¨"><a href="#6-4ã€useCallbackçš„æ»¥ç”¨" class="headerlink" title="6-4ã€useCallbackçš„æ»¥ç”¨"></a>6-4ã€useCallbackçš„æ»¥ç”¨</h3><p>ä¸ºä»€ä¹ˆæ»¥ç”¨useCallbackæœ‰æ—¶å€™ä¼šé€‚å¾—å…¶åï¼Ÿ</p>
<p>å•ä»ç»„ä»¶ä¸Šçœ‹ï¼Œå†…è”å‡½æ•°æ˜¯ä¸€å®šä¼šåˆ›å»ºçš„ï¼ˆä¸Šé¢çš„callbackå†…è”å‡½æ•°ï¼‰ï¼Œè€Œæ— æ„ä¹‰çš„åˆ›å»ºå’Œå†…éƒ¨æ¯æ¬¡çš„æµ…æ¯”è¾ƒéƒ½æ˜¯ä¼šæ¶ˆè€—ä¸€å®šæ€§èƒ½çš„ã€‚</p>
<p>å› æ­¤useCallbackçš„ä½¿ç”¨ä¸€å®šè¦åˆ†æ¸…ä½¿ç”¨åœºæ™¯æ‰èƒ½è¾¾åˆ°æ•ˆæœã€‚</p>


    

        <!-- Comments -->
        <div class="comments" id="zss">
          
            <br><br>
            
              <div class="disqus" style="width:100%">
    <div id="disqus_thread"></div>
    <script>
        var disqus_shortname = 'shanshan';
        var disqus_config = function () {
            this.page.url = 'https://piggyzss.github.io/2022/04/05/ReactHooks(ä¸€)/';
            this.page.identifier = '/2022/04/05/ReactHooks(ä¸€)/';
        };
        (function() {
            var d = document, s = d.createElement('script');
            s.type = 'text/javascript';
            s.src = '//'+disqus_shortname+'.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow noopener">comments powered by Disqus.</a></noscript>
</div>

    <div id="gitment_title" class="gitment_title"></div>
    <div id="container" style="display:none"></div>
    <link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
    <script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script>
      const myTheme = {
        render(state, instance) {
          const container = document.createElement('div');
          container.lang = "en-US";
          container.className = 'gitment-container gitment-root-container';
          container.appendChild(instance.renderHeader(state, instance));
          container.appendChild(instance.renderEditor(state, instance));
          container.appendChild(instance.renderComments(state, instance));
          container.appendChild(instance.renderFooter(state, instance));
          return container;
        }
      }
      function showGitment() {
        $("#gitment_title").attr("style", "display:none");
        $("#zss").attr("style", "").addClass("gitment_container");
        var gitment = new Gitment({
          id: decodeURI(window.location.pathname),
          theme: myTheme,
          owner: 'piggyzss',
          repo: 'piggyzss.github.io/',
          oauth: {
            client_id: '09a2760e2209a8728279',
            client_secret: '1162d7e456f9c8d3f15f164e63f5d253679445a5'
          }
        });
        gitment.render('zss');
      }
      showGitment();
    </script>

                
        </div>

        <!--<div id="comment"></div>-->

</article>
      </div>
      <footer>
        <div class="copyright">
          Â©2019 <a href="https://piggyzss.github.io">
            Powered by shanshan
        </a></div>
        
      </footer>
    </div>
    <div id="card-wrap">
      <div class="card">
        <div class="logo-widget">
          <div class="author">
            SecretGarden
          </div>
          <!--<div class="logo" style="background-image: url('/images/logo.jpeg')"></div>-->
        </div>
        <div class="locate-widget">
          <div class="city-wrap">
            <svg class="icon location" aria-hidden="true">
              <use xlink:href="#icon-fenzu9"/>
            </svg>
            <span id="city-name"></span>
          </div>
          <div class="weather-wrap">
            <div id="weather-img">
              <svg class="icon weather" aria-hidden="true">
                <use xlink:href="#icon-qingjiafeng"/>
              </svg>
            </div>
            <div id="weather-detail"></div>
          </div>
        </div>
        <div class="follow-widget">
          
            <a href="https://github.com/piggyzss" target="_block">
              <svg class="icon font" aria-hidden="true">
                <use xlink:href="#icon-github"/>
              </svg>
            </a>
            
            <a href="https://www.instagram.com/doudou_lucky7/" target="_block">
              <svg class="icon font" aria-hidden="true">
                <use xlink:href="#icon-instagram"/>
              </svg>
            </a>
            
            <a href target="_block">
              <svg class="icon font" aria-hidden="true">
                <use xlink:href="#icon-weibo"/>
              </svg>
            </a>
            
              
                <a href="/atom.xml" target="_block">
                  <svg class="icon font" aria-hidden="true">
                    <use xlink:href="#icon-rss"/>
                  </svg>
                </a>
                
        </div>
        
          
            <div class="toc-widget">
              <div class="title">
                <span>Toc</span>
              </div>
              <div class="post-toc">
                <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1ã€ä»€ä¹ˆæ˜¯hooksä»¥åŠä¸ºä»€ä¹ˆæ˜¯hooksï¼Ÿ"><span class="toc-text">1ã€ä»€ä¹ˆæ˜¯hooksä»¥åŠä¸ºä»€ä¹ˆæ˜¯hooksï¼Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1ã€ä»€ä¹ˆæ˜¯hooksï¼Ÿ"><span class="toc-text">1-1ã€ä»€ä¹ˆæ˜¯hooksï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2ã€ä¸ºä»€ä¹ˆæ˜¯hooks"><span class="toc-text">1-2ã€ä¸ºä»€ä¹ˆæ˜¯hooks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3ã€ã€æ³¨æ„ã€‘"><span class="toc-text">1-3ã€ã€æ³¨æ„ã€‘</span></a></li></ol></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#2ã€useState"><span class="toc-text">2ã€useState</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1ã€å…¥å‚"><span class="toc-text">2-1ã€å…¥å‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2ã€å‡½æ•°å¼æ›´æ–°"><span class="toc-text">2-2ã€å‡½æ•°å¼æ›´æ–°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3ã€æ›´æ–°ï¼šæ›¿æ¢éåˆå¹¶"><span class="toc-text">2-3ã€æ›´æ–°ï¼šæ›¿æ¢éåˆå¹¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4ã€æ€§èƒ½é—®é¢˜"><span class="toc-text">2-4ã€æ€§èƒ½é—®é¢˜</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3ã€useEffect"><span class="toc-text">3ã€useEffect</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1ã€å…¥å‚"><span class="toc-text">3-1ã€å…¥å‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2ã€é—­åŒ…é—®é¢˜"><span class="toc-text">3-2ã€é—­åŒ…é—®é¢˜</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4ã€useContext"><span class="toc-text">4ã€useContext</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5ã€useMemo"><span class="toc-text">5ã€useMemo</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1ã€å…¥å‚"><span class="toc-text">5-1ã€å…¥å‚</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6ã€useCallback"><span class="toc-text">6ã€useCallback</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1ã€å…¥å‚"><span class="toc-text">6-1ã€å…¥å‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2ã€ä¸€äº›èƒŒæ™¯å°çŸ¥è¯†"><span class="toc-text">6-2ã€ä¸€äº›èƒŒæ™¯å°çŸ¥è¯†</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#React-memo"><span class="toc-text">React.memo()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3ã€ä»€ä¹ˆåœºæ™¯ä¸‹éœ€è¦ä½¿ç”¨useCallback"><span class="toc-text">6-3ã€ä»€ä¹ˆåœºæ™¯ä¸‹éœ€è¦ä½¿ç”¨useCallback</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4ã€useCallbackçš„æ»¥ç”¨"><span class="toc-text">6-4ã€useCallbackçš„æ»¥ç”¨</span></a></li></ol></li>
              </div>
            </div>
            
              
                <div class="category-widget">
                  <div class="title">
                    <span>Categories</span>
                    <span><a href="/archives">Â·Â·Â·</a></span>
                  </div>
                  <div class="list">
                    <ul>
                      
                        
                          <li>
                            <a href="/categories/code/">
                              code
                            </a>
                          </li>
                          
                            
                    </ul>
                  </div>
                </div>
                <div class="tag-widget">
                  <div class="title">
                    <span>Tag Cloud</span>
                    <span><a href>Â·Â·Â·</a></span>
                  </div>
                  <div class="tag-cloud">
                    <a href="/tags/React/" style="font-size: 16.5px; color: #4a4a4a">React</a> <a href="/tags/å‰ç«¯/" style="font-size: 20px; color: #4a4a4a">å‰ç«¯</a> <a href="/tags/è®¾è®¡æ¨¡å¼/" style="font-size: 13px; color: #4a4a4a">è®¾è®¡æ¨¡å¼</a>
                  </div>
                </div>
      </div>
    </div>
  </div>
</body>

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WJ7P5KL" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  

</html>
<script type="text/javascript">
  window.THEME_CONFIG = JSON.parse('{"title":"Hexo","subtitle":null,"description":null,"author":"shanshan","language":"en","timezone":null,"url":"https://piggyzss.github.io","root":"/","permalink":":year/:month/:day/:title/","permalink_defaults":null,"source_dir":"source","public_dir":"public","tag_dir":"tags","archive_dir":"archives","category_dir":"categories","code_dir":"downloads/code","i18n_dir":":lang","skip_render":null,"new_post_name":":title.md","default_layout":"post","titlecase":false,"external_link":true,"filename_case":0,"render_drafts":false,"post_asset_folder":true,"relative_link":false,"future":true,"highlight":{"enable":false,"auto_detect":false,"line_number":true,"tab_replace":null},"default_category":"uncategorized","category_map":null,"tag_map":null,"date_format":"YYYY-MM-DD","time_format":"HH:mm:ss","per_page":10,"pagination_dir":"page","theme":"hexo-theme-huhu","deploy":{"type":"git","repository":"https://github.com/piggyzss/piggyzss.github.io.git","branch":"master"},"ignore":[],"keywords":null,"highlight_theme":"normal","index_generator":{"per_page":10,"order_by":"-date","path":""},"gitment":{"enable":true,"mint":true,"count":true,"lazy":false,"cleanly":false,"language":null,"github_user":"piggyzss","github_repo":"piggyzss.github.io/","client_id":"09a2760e2209a8728279","client_secret":"1162d7e456f9c8d3f15f164e63f5d253679445a5","proxy_gateway":null,"redirect_protocol":null},"category_generator":{"per_page":10},"archive_generator":{"per_page":10,"yearly":true,"monthly":true,"daily":false},"tag_generator":{"per_page":10},"marked":{"gfm":true,"pedantic":false,"breaks":true,"smartLists":true,"smartypants":true,"modifyAnchors":"","autolink":true,"sanitizeUrl":false,"headerIds":true},"server":{"port":4000,"log":false,"compress":false,"header":true},"menu":{"home":"/","archives":"/archives","about":"/about","music":"/music","gallery":"/gallery"},"logo":"/images/logo.png","categories_max":5,"tags_max":10,"favicon":"/images/favicon.ico","site_search":true,"rss":"/atom.xml","follow":{"github":"https://github.com/piggyzss","instagram":"https://www.instagram.com/doudou_lucky7/","weibo":""},"search_url":"/search.xml","site_icp":"","site_friends":{"æˆ¿é—´é‡Œçš„å°çŒ«å’ª":"http://baidu.com"},"changyan":{"appid":"","conf":""},"valine":{"API_ID":"FjXColpwTL0BsrjJIN8Pmnn0-gzGzoHsz","API_KEY":"Ar7tucPRn3KV7UOidQxESoys"},"share":["weibo","weixin","qqkongjian","QQ","douban","facebook","twitter","google"],"cdn_module":{"av_min":"https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min","jquery":"https://cdn.bootcss.com/jquery/3.4.1/jquery.min","busuanzi":"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini","confirm":"https://cdn.bootcss.com/jquery-confirm/3.3.4/jquery-confirm.min","fancybox":"https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min"},"google_site_verification":"VQowHv5lAVVWJxjKI9bnAWT7NGdOrfS5KnLF07-B7w0","gtm_id":"GTM-WJ7P5KL","baidu_push":true,"reward":{"weixin":"images/weixin.png","zhifubao":"images/zhifubao.png"},"disqus":{"shortname":"shanshan"},"post":{"date_format":"dddd, MMMM Do YYYY, h:mm a","comments":{"enable":true,"type":"disqus"}}}')
  window.loadJs = function (d, m, a) {
    var c = document.getElementsByTagName('head')[0] || document.head || document.documentElement
    var b = document.createElement('script')
    b.defer = true
    b.setAttribute('type', 'text/javascript')
    b.setAttribute('charset', 'UTF-8')
    b.setAttribute('async', 'true')
    b.setAttribute('src', d)
    m && b.setAttribute('data-main', '/scripts/app')
    if (typeof a === 'function') {
      if (window.attachEvent) {
        b.onreadystatechange = function () {
          var e = b.readyState
          if (e === 'loaded' || e === 'complete') {
            b.onreadystatechange = null
            a()
          }
        }
      } else {
        b.onload = a
      }
    }
    c.appendChild(b)
  }
  loadJs('https://cdn.bootcss.com/require.js/2.3.6/require.min.js', true, function () {
    require.config({
      paths: {
        // site
        share: 'share',
        iconfont: 'iconfont',
        hodgepodge: 'hodgepodge',
        valine: ['cdn/Valine.min'],

        // cdn
        av: ['https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min', 'cdn/av-min'],
        jquery: ['https://cdn.bootcss.com/jquery/3.4.1/jquery.min', 'cdn/jquery.min'],
        busuanzi: ['//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini', 'cdn/busuanzi.pure.mini'],
        confirm: ['https://cdn.bootcss.com/jquery-confirm/3.3.4/jquery-confirm.min', 'cdn/jquery.confirm.min'],
        fancybox: ['https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min', 'cdn/jquery.fancybox.min']
      },

      map: {
        '*': {
          // css: '/scripts/cdn/css-min.js'
          css: 'https://cdn.bootcss.com/require-css/0.1.10/css.min.js'
        }
      },

      shim: {
        fancybox: {
          // deps: ['css!../style/fancybox']
          deps: ['css!https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.css']
        },
        confirm: {
          // deps: ['css!../style/confirm']
          deps: ['css!https://cdn.bootcss.com/jquery-confirm/3.3.4/jquery-confirm.min.css']
        }
      },

      // åŠ è½½è¶…æ—¶
      waitSeconds: 3
    })
  })
</script>

  <script>
      ; (function () {
        var bp = document.createElement('script')
        var curProtocol = window.location.protocol.split(':')[0]
        if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js'
        } else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js'
        }
        var s = document.getElementsByTagName('script')[0]
        s.parentNode.insertBefore(bp, s)
      })()
  </script>
  