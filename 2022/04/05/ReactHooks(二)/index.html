<!DOCTYPE html>
<html>

<head><meta name="generator" content="Hexo 3.9.0">
  
    <!-- Google Tag Manager -->
    <script>
      ; (function (w, d, s, l, i) {
        w[l] = w[l] || []
        w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' })
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != 'dataLayer' ? '&l=' + l : ''
        j.async = true
        j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl
        f.parentNode.insertBefore(j, f)
      })(window, document, 'script', 'dataLayer', 'GTM-WJ7P5KL')
    </script>
    <!-- End Google Tag Manager -->

    <script>
      var _hmt = _hmt || []
        ; (function () {
          var hm = document.createElement('script')
          hm.src = 'https://hm.baidu.com/hm.js?5a0acc897fd96474a2c8f4deac84611a'
          var s = document.getElementsByTagName('script')[0]
          s.parentNode.insertBefore(hm, s)
        })()
    </script>
    <!-- 百度统计 -->

    
      <meta charset="utf-8">
      <meta name="baidu-site-verification" content="vvVgSQUzPU">
      <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
      <meta name="keywords" content>
      
        <meta name="google-site-verification" content="VQowHv5lAVVWJxjKI9bnAWT7NGdOrfS5KnLF07-B7w0">
        
          <meta name="description" content>
          <title>
            Hexo - 
          </title>

          <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon">
          <link rel="stylesheet" href="/style/style.css">
            <link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css">
            <script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script>
            <link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css">
            <script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script>
            <script>
              hljs.initHighlightingOnLoad();
            </script>
            <script type="text/javascript" src="https://unpkg.com/minigrid@3.1.1/dist/minigrid.min.js"></script>
            <link rel="stylesheet" href="../source/photos/photos.css">
            <script type="text/javascript" src="../source/photos/photo.js"></script>
</head>

<body>
  <div id="fixed-menu">
    <div class="up">
      <svg class="icon" aria-hidden="true">
        <use xlink:href="#icon-fenzu7"/>
      </svg>
    </div>
  </div>
  <div id="progress">
    <div class="line"></div>
  </div>
  <div id="head">
    
      <a href="/" class>
        Home
      </a>
      
      <a href="/archives" class>
        Archives
      </a>
      
      <a href="/about" class>
        About
      </a>
      
      <a href="/music" class>
        music
      </a>
      
      <a href="/gallery" class>
        gallery
      </a>
      
  </div>
  <div id="container">
    <div id="main">
      <div class="navbar">
        <div class="toggle">
          <svg class="icon toggle-icon" aria-hidden="true">
            <use xlink:href="#icon-fenzu3"/>
          </svg>
        </div>
        <div class="search">
          <div class="input-warp">
            <svg class="icon" aria-hidden="true">
              <use xlink:href="#icon-fenzu"/>
            </svg>
            <input type="text" name id="search" placeholder="Search Keys">
          </div>
        </div>
      </div>
      <div class="content">
        <article class="post-entry">
  <div class="header">
    <div class="title">
      ReactHooks(二)
    </div>
    
      <div class="meta">
        <span>
          <svg class="icon" aria-hidden="true">
            <use xlink:href="#icon-fenzu4"/>
          </svg>
          2022/04/05
        </span>
        <span>
          <svg class="icon" aria-hidden="true">
            <use xlink:href="#icon-fenzu14"/>
          </svg>
          <span>
            
              
                      
          </span>
        </span>
        <span>
          <svg class="icon" aria-hidden="true">
            <use xlink:href="#icon-fenzu15"/>
          </svg>
          <span>
            
              
                
                  <a href="/tags/React">
                    React
                  </a>
                  
                    
                      
          </span>
        </span>
        <span class="leancloud-visitors" id="https://piggyzss.github.io/2022/04/05/ReactHooks(二)/" data-flag-title="ReactHooks(二)">
          <svg class="icon" aria-hidden="true">
            <use xlink:href="#icon-fenzu6"/>
          </svg>
          <span class="leancloud-visitors-count"></span>
        </span>
      </div>
      
        
            <div>
            </div>
  </div>
  <h1 id="1、useRef"><a href="#1、useRef" class="headerlink" title="1、useRef"></a>1、useRef</h1><p>useRef的作用是“勾住”某些组件挂载完成或重新渲染完成后才拥有的某些对象，并返回该对象的引用。该引用在组件整个生命周期中都固定不变，并且不会随着组件重新渲染而失效。</p>
<pre><code class="javascript">const refContainer = useRef(initialValue)</code></pre>
<p>useRef 返回一个可变的 ref 对象，其 .current 属性被初始化为传递的参数（initialValue）。返回的对象将存留在整个组件的生命周期中。</p>
<ul>
<li>从本质上讲，useRef就像一个“盒子”，可以在其.current中保持一个可变值。</li>
</ul>
<!---->

<ul>
<li>useRef不仅适用于 DOM 引用。 <code>ref</code> 对象是一个通用容器，其 current 属性是可变的，可以保存任何可变值（可以是元素、对象、基本类型、甚至函数），类似于类中使用 instance(实例) 字段的方式。</li>
</ul>
<p><strong>下面我们会从ref可能使用的几种场景来分别举例。</strong></p>
<h3 id="1-1、勾住DOM"><a href="#1-1、勾住DOM" class="headerlink" title="1-1、勾住DOM"></a>1-1、勾住DOM</h3><p>某些场景下，我们需要获取组件的实例或者DOM元素来进行一些操作。</p>
<h4 id="原生标签组件"><a href="#原生标签组件" class="headerlink" title="原生标签组件"></a>原生标签组件</h4><p>栗子：有一个输入框组件，希望挂载后自动获取焦点</p>
<pre><code class="javascript">import React, { useEffect, useRef } from &#39;react&#39;

const Component = () =&gt; {
  const inputRef = useRef(null)

  useEffect(() =&gt; {
    // inputRef.current获取输入框DOM，因此可以调用html中的方法focus()
    inputRef.current.focus()
  }, []);

  return &lt;div&gt;
    {/* 通过 ref 属性将 inputRef与输入框进行“挂钩” */}
    &lt;input type=&#39;text&#39; ref={inputRef} /&gt;
  &lt;/div&gt;
}
export default Component</code></pre>
<h4 id="自定义组件"><a href="#自定义组件" class="headerlink" title="自定义组件"></a>自定义组件</h4><p>需要借助<code>React.forwardRef</code></p>
<p>栗子：</p>
<pre><code class="javascript">C1.jsx
import React from &#39;react&#39;

const C1 = React.forwardRef((props, ref) =&gt; {
  return (
    &lt;input type=&#39;text&#39; ref={ref} /&gt;
  )
})

export default C1


Component.jsx
import React, { useEffect, useRef } from &#39;react&#39;
import C1 from &#39;./C1&#39;

const Component = () =&gt; {
  const inputRef = useRef(null)

  useEffect(() =&gt; {
    inputRef.current.focus()
  }, [])

  return &lt;div&gt;
    &lt;C1 ref={inputRef} /&gt;
  &lt;/div&gt;
}
export default Component</code></pre>
<h3 id="1-2、勾住变量"><a href="#1-2、勾住变量" class="headerlink" title="1-2、勾住变量"></a>1-2、勾住变量</h3><blockquote>
<p>It’s handy for keeping any mutable value around similar to how you’d use instance fields in classes.</p>
</blockquote>
<p>官方参考：<a href="https://reactjs.org/docs/hooks-faq.html#is-there-something-like-instance-variables" target="_blank" rel="noopener">https://reactjs.org/docs/hooks-faq.html#is-there-something-like-instance-variables</a></p>
<p>先看下面这个例子：</p>
<p>1、组件中有一个变量count，当该组件挂载到网页后，count每秒自动 +1 2、组件中有一个按钮，点击按钮可以停止count自动+1</p>
<p>因此，需要有一个内部变量timer来记录定时器ID，点击按钮时则利用这个定时器ID来清除。这个内部变量在每次重渲染的时候不会改变，因此需要用ref来实现。</p>
<pre><code class="javascript">import React, { useState, useEffect, useRef } from &#39;react&#39;

const Component = () =&gt; {
  const [count, setCount] = useState(0)
  const timer = useRef(null)

  useEffect(() =&gt; {
    timer.current = setInterval(() =&gt; {
      setCount(pre =&gt; pre + 1)
    }, 500)
    return () =&gt; {
      //通过timer.current，清除掉计时器
      clearInterval(timer.current)
    }
  }, [])

  const handleClick = () =&gt; {
    clearInterval(timer.current)
  }

  return (
    &lt;div&gt;
      &lt;h1&gt;{count}&lt;/h1&gt;
      &lt;h2 onClick={handleClick}&gt;clear&lt;/h2&gt;
    &lt;/div&gt;
  )
}
export default Component</code></pre>
<p>useRef 会在每次渲染时返回同一个 ref 对象。更改.current属性不会引起组件重新渲染，因为他一直是一个引用 。</p>
<h3 id="1-3、获取previous-props-或previous-state"><a href="#1-3、获取previous-props-或previous-state" class="headerlink" title="1-3、获取previous props 或previous state"></a>1-3、获取previous props 或previous state</h3><pre><code class="javascript">import React, { useState, useRef, useEffect } from &#39;react&#39;

const Component = (props) =&gt; {
  const [count, setCount] = useState(0)

  // previous props
  // const prevPropsRef = useRef()
  // useEffect(() =&gt; {
  //   prevPropsRef.current = props
  // })

  // previous state
  const prevCountRef = useRef(null)
  useEffect(() =&gt; {
    prevCountRef.current = count
  })

  return (
    &lt;div&gt;
      &lt;div&gt;prevCount: {prevCountRef.current}&lt;/div&gt;
      &lt;div&gt;count: {count}&lt;/div&gt;
      &lt;button onClick={() =&gt; { setCount(count + 1) }}&gt;Add&lt;/button&gt;
    &lt;/div&gt;
  )
}

export default Component</code></pre>
<h3 id="1-4、获取子组件的属性或方法-useImperativeHandle"><a href="#1-4、获取子组件的属性或方法-useImperativeHandle" class="headerlink" title="1-4、获取子组件的属性或方法(useImperativeHandle)"></a>1-4、获取子组件的属性或方法(useImperativeHandle)</h3><blockquote>
<p>While you shouldn’t need this often, you may expose some imperative methods to a parent component with the <code>useImperativeHandle</code> Hook.</p>
</blockquote>
<p>需要借助<code>React.useImperativeHandle</code></p>
<p><code>useImperativeHandle</code>也是React提供的hooks之一，作用是“勾住”子组件中某些方法或属性供父组件调用。</p>
<p>我们都知道，React属于单向数据流，子组件想要访问父组件的函数(方法)，可以通过属性传值将父组件内的函数(方法)传递给子组件，实现子组件调用父组件内函数的目的。而父组件想要访问子组件的函数(方法)，则需要借助hooks来实现。</p>
<p>栗子：</p>
<pre><code class="javascript">C1.jsx
import React, { useState, useImperativeHandle } from &#39;react&#39;

const C1 = (props, ref) =&gt; {
  const [count, setCount] = useState(0)

  const addCount = () =&gt; {
    setCount(count + 1);
  }

  //子组件通过useImperativeHandle函数，将需要暴露给父组件的方法添加到父组件中的ref.current中
  useImperativeHandle(ref, () =&gt; ({
    getValue() {
      return count
    }
  }))
  return (
    &lt;div&gt;
      {count}
      &lt;button onClick={addCount}&gt;child&lt;/button&gt;
    &lt;/div&gt;
  )
}

export default React.forwardRef(C1)


Component.jsx
import React, { useRef } from &#39;react&#39;
import C1 from &#39;./C1&#39;

const Component = (props) =&gt; {
  const ref = useRef(null)

  const handleClick = () =&gt; {
    console.log(ref.current.getValue())
  }

  return (
    &lt;div&gt;
      &lt;C1 ref={ref} /&gt;
      &lt;button onClick={handleClick}&gt;submit&lt;/button&gt;
    &lt;/div&gt;
  )
}

export default Component</code></pre>
<p><a href="https://dev.to/dinhhuyams/introduction-to-useref-hook-3m7n" target="_blank" rel="noopener">https://dev.to/dinhhuyams/introduction-to-useref-hook-3m7n</a></p>
<h1 id="2、useLayoutEffect"><a href="#2、useLayoutEffect" class="headerlink" title="2、useLayoutEffect"></a>2、useLayoutEffect</h1><p>useLayoutEffect的作用是“勾住”<strong>挂载完成</strong>或<strong>重渲染完成</strong>这2个生命周期函数。</p>
<p>useLayoutEffect使用方法、参数和<code>useEffect</code>完全相同。区别在于，当组件所有DOM都渲染完成后，先同步调用useLayoutEffect，然后再调用useEffect。</p>
<h3 id="2-1、什么场景下需要使用useLayoutEffect"><a href="#2-1、什么场景下需要使用useLayoutEffect" class="headerlink" title="2-1、什么场景下需要使用useLayoutEffect"></a>2-1、什么场景下需要使用useLayoutEffect</h3><p>某些情况下，在组件更新时需要重新set依赖项的时候，比如下面这个栗子：</p>
<pre><code class="javascript">const Component = (props) =&gt; {
  const [count, setCount] = useState(0);

  // useEffect(() =&gt; {
  //   // 一些耗时的操作
  //   const pre = Date.now()
  //   while (Date.now() - pre &lt; 500) { }

  //   // count为0时重新生成随机数
  //   if (count === 0) {
  //     setCount(Math.random() * 200)
  //   }
  // }, [count])

  useLayoutEffect(() =&gt; {
    // 一些耗时的操作
    const pre = Date.now()
    while (Date.now() - pre &lt; 500) { }

    // count为0时重新生成随机数
    if (count === 0) {
      setCount(Math.random() * 200)
    }
  }, [count])

  return (
    &lt;div onClick={() =&gt; setCount(0)}&gt;{count}&lt;/div&gt;
  )
}

export default Component</code></pre>
<p>上面栗子中，页面展示随机数字，点击div，先将count设置为0，然后判断count为0时重新生成随机数进行set。</p>
<p>当使用useEffect时，点击div可以明显看到页面有闪烁（一个跳到0再显示出随机数的过程）。</p>
<p>但改为useLayoutEffect后，当点击 div，count 更新为 0，由于它是同步调用的，此时页面并不会渲染，而是等待<code>useLayoutEffect</code>内部状态修改后，才会去更新页面，所以页面不会闪烁。</p>
<p>结论：</p>
<ul>
<li>无特殊情况优先使用 useEffect，useEffect异步执行，不会阻塞渲染；useLayoutEffect和componentDidMount是等价的，会同步调用，会阻塞渲染</li>
</ul>
<!---->

<ul>
<li>会影响到渲染的操作可以放到 useLayoutEffect中去，避免出现闪烁问题</li>
</ul>
<!---->

<ul>
<li>在服务端渲染的时候使用会有一个 warning，因为它可能导致首屏实际内容和服务端渲染出来的内容不一致【此处仅同步官网需要注意的地方，具体case后续待补充】</li>
</ul>
<h1 id="3、自定义hooks"><a href="#3、自定义hooks" class="headerlink" title="3、自定义hooks"></a>3、自定义hooks</h1><p>除了React官方提供的Hooks，我们也可以根据自己的实际使用场景构造一些Hooks。</p>
<p>自定义hooks本质上就是把组件内的hooks逻辑抽离出来，提取到可重用的函数中。</p>
<h3 id="3-1、自定义hooks"><a href="#3-1、自定义hooks" class="headerlink" title="3-1、自定义hooks"></a>3-1、自定义hooks</h3><p><strong>自定义 Hook 是一个函数，其名称以 “</strong> <strong><code>use</code></strong> <strong>” 开头，函数内部可以调用其他的 Hook。</strong></p>
<p>举个栗子</p>
<pre><code class="javascript">hooks.js
import { useEffect, useRef } from &#39;react&#39;
export const useDebounce = (fn, ms = 30, deps = []) =&gt; {
  const timeout = useRef()
  useEffect(() =&gt; {
    if (timeout.current) clearTimeout(timeout.current)
    timeout.current = setTimeout(() =&gt; {
      fn()
    }, ms)
  }, deps)

  const cancel = () =&gt; {
    clearTimeout(timeout.current)
    timeout = null
  }

  return [cancel]
}


Component.jsx
import React, { useState } from &#39;react&#39;
import { useDebounce } from &#39;hooks&#39;
const Component = (props) =&gt; {
  const [a, setA] = useState(0)
  const [b, setB] = useState(0)
  const [cancel] = useDebounce(() =&gt; {
    setB(a)
  }, 200, [a])

  const handleChange = (e) =&gt; {
    setA(e.target.value)
  }

  return &lt;div&gt;
    &lt;input type=&quot;text&quot; onChange={handleChange} /&gt;
    {b} {a}
  &lt;/div&gt;
}
export default Component</code></pre>
<p>上面栗子实现了一个防抖的hook，可以看到，hooks和其他普通的函数并没有什么不同，我们根据需要决定它的参数是什么，以及它应该返回什么（如果需要的话）。区别仅仅在于它的名字始终以 <code>use</code> 开头，以此来区别其他普通函数。</p>
<p>其他关于hooks需要注意的地方</p>
<blockquote>
<p><strong>在两个组件中使用相同的 Hook 会共享 state 吗？</strong> 不会。自定义 Hook 是一种重用<em>状态逻辑</em>的机制(例如设置为订阅并存储当前值)，所以每次使用自定义 Hook 时，其中的所有 state 和副作用都是完全隔离的。</p>
</blockquote>
<h1 id="4、一些扩展"><a href="#4、一些扩展" class="headerlink" title="4、一些扩展"></a>4、一些扩展</h1><ul>
<li>react-use</li>
</ul>
<p><a href="https://github.com/streamich/react-use" target="_blank" rel="noopener">https://github.com/streamich/react-use</a></p>
<p>一个很强大的hooks库，提供了例如useToggle、useObservable、useAsync等常用的hooks封装。</p>
<ul>
<li>SWR</li>
</ul>
<p><a href="https://swr.vercel.app/zh-CN" target="_blank" rel="noopener">https://swr.vercel.app/zh-CN</a></p>
<p>用于数据请求的 React Hooks 库</p>
<ul>
<li>React源码分析</li>
</ul>
<p><a href="https://react.iamkasong.com/" target="_blank" rel="noopener">https://react.iamkasong.com/</a></p>
<ul>
<li>React Hooks 最佳实践</li>
</ul>
<p><a href="https://mp.weixin.qq.com/s/HwlnvAh18saKwXC_nZwSHw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/HwlnvAh18saKwXC_nZwSHw</a></p>


    

        <!---->
        <!--<div class="post-reward">-->
        <!--<div id="reward-button">请杯咖啡呗~</div>-->
        <!--<div id="qr">-->
        <!--<div class="wrap">-->
        <!---->
        <!--<div class="bg-wrap">-->
        <!--<a href="/images/zhifubao.png" target="_block" class="bg" style="background-image:url('/images/zhifubao.png')"></a>-->
        <!--支付宝-->
        <!--</div>-->
        <!---->
        <!---->
        <!--<div class="bg-wrap">-->
        <!--<a href="/images/weixin.png" target="_block" class="bg" style="background-image:url('/images/weixin.png')"></a>-->
        <!--微信-->
        <!--</div>-->
        <!---->
        <!--</div>-->
        <!--</div>-->
        <!---->

        <!--</div>-->

        <!--<div class="post-copyright">-->
        <!--<div class="auth">-->
        <!--本文作者：<a href="https://piggyzss.github.io">shanshan</a>-->
        <!--</div>-->
        <!--<div class="link">-->
        <!--永久链接：<a href="https://piggyzss.github.io/2022/04/05/ReactHooks(二)/">https://piggyzss.github.io/2022/04/05/ReactHooks(二)/</a>-->
        <!--</div>-->
        <!--<div class="declare">-->
        <!--版权声明：本文首发于<a href="https://piggyzss.github.io">shanshan</a>的博客，转载请注明出处！-->
        <!--</div>-->
        <!--</div>-->

        <!-- Comments -->
        <div class="comments" id="zss">
          
            <br><br>
            
              <div class="disqus" style="width:100%">
    <div id="disqus_thread"></div>
    <script>
        var disqus_shortname = 'shanshan';
        var disqus_config = function () {
            this.page.url = 'https://piggyzss.github.io/2022/04/05/ReactHooks(二)/';
            this.page.identifier = '/2022/04/05/ReactHooks(二)/';
        };
        (function() {
            var d = document, s = d.createElement('script');
            s.type = 'text/javascript';
            s.src = '//'+disqus_shortname+'.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow noopener">comments powered by Disqus.</a></noscript>
</div>

    <div id="gitment_title" class="gitment_title"></div>
    <div id="container" style="display:none"></div>
    <link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
    <script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script>
      const myTheme = {
        render(state, instance) {
          const container = document.createElement('div');
          container.lang = "en-US";
          container.className = 'gitment-container gitment-root-container';
          container.appendChild(instance.renderHeader(state, instance));
          container.appendChild(instance.renderEditor(state, instance));
          container.appendChild(instance.renderComments(state, instance));
          container.appendChild(instance.renderFooter(state, instance));
          return container;
        }
      }
      function showGitment() {
        $("#gitment_title").attr("style", "display:none");
        $("#zss").attr("style", "").addClass("gitment_container");
        var gitment = new Gitment({
          id: decodeURI(window.location.pathname),
          theme: myTheme,
          owner: 'piggyzss',
          repo: 'piggyzss.github.io/',
          oauth: {
            client_id: '09a2760e2209a8728279',
            client_secret: '1162d7e456f9c8d3f15f164e63f5d253679445a5'
          }
        });
        gitment.render('zss');
      }
      showGitment();
    </script>

                
        </div>

        <!--<div id="comment"></div>-->

</article>
      </div>
      <footer>
        <div class="copyright">
          ©2019 <a href="https://piggyzss.github.io">
            Powered by shanshan
        </a></div>
        
      </footer>
    </div>
    <div id="card-wrap">
      <div class="card">
        <div class="logo-widget">
          <div class="author">
            SecretGarden
          </div>
          <!--<div class="logo" style="background-image: url('/images/logo.jpeg')"></div>-->
        </div>
        <div class="locate-widget">
          <div class="city-wrap">
            <svg class="icon location" aria-hidden="true">
              <use xlink:href="#icon-fenzu9"/>
            </svg>
            <span id="city-name"></span>
          </div>
          <div class="weather-wrap">
            <div id="weather-img">
              <svg class="icon weather" aria-hidden="true">
                <use xlink:href="#icon-qingjiafeng"/>
              </svg>
            </div>
            <div id="weather-detail"></div>
          </div>
        </div>
        <div class="follow-widget">
          
            <a href="https://github.com/piggyzss" target="_block">
              <svg class="icon font" aria-hidden="true">
                <use xlink:href="#icon-github"/>
              </svg>
            </a>
            
            <a href="https://www.instagram.com/doudou_lucky7/" target="_block">
              <svg class="icon font" aria-hidden="true">
                <use xlink:href="#icon-instagram"/>
              </svg>
            </a>
            
            <a href target="_block">
              <svg class="icon font" aria-hidden="true">
                <use xlink:href="#icon-weibo"/>
              </svg>
            </a>
            
              
                <a href="/atom.xml" target="_block">
                  <svg class="icon font" aria-hidden="true">
                    <use xlink:href="#icon-rss"/>
                  </svg>
                </a>
                
        </div>
        
          
            <div class="toc-widget">
              <div class="title">
                <span>Toc</span>
              </div>
              <div class="post-toc">
                <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1、useRef"><span class="toc-text">1、useRef</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1、勾住DOM"><span class="toc-text">1-1、勾住DOM</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#原生标签组件"><span class="toc-text">原生标签组件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#自定义组件"><span class="toc-text">自定义组件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2、勾住变量"><span class="toc-text">1-2、勾住变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3、获取previous-props-或previous-state"><span class="toc-text">1-3、获取previous props 或previous state</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4、获取子组件的属性或方法-useImperativeHandle"><span class="toc-text">1-4、获取子组件的属性或方法(useImperativeHandle)</span></a></li></ol></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#2、useLayoutEffect"><span class="toc-text">2、useLayoutEffect</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1、什么场景下需要使用useLayoutEffect"><span class="toc-text">2-1、什么场景下需要使用useLayoutEffect</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3、自定义hooks"><span class="toc-text">3、自定义hooks</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1、自定义hooks"><span class="toc-text">3-1、自定义hooks</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4、一些扩展"><span class="toc-text">4、一些扩展</span></a></li>
              </div>
            </div>
            
              
                <div class="category-widget">
                  <div class="title">
                    <span>Categories</span>
                    <span><a href="/archives">···</a></span>
                  </div>
                  <div class="list">
                    <ul>
                      
                        
                          <li>
                            <a href="/categories/code/">
                              code
                            </a>
                          </li>
                          
                            
                    </ul>
                  </div>
                </div>
                <div class="tag-widget">
                  <div class="title">
                    <span>Tag Cloud</span>
                    <span><a href>···</a></span>
                  </div>
                  <div class="tag-cloud">
                    <a href="/tags/React/" style="font-size: 16.5px; color: #4a4a4a">React</a> <a href="/tags/前端/" style="font-size: 20px; color: #4a4a4a">前端</a> <a href="/tags/设计模式/" style="font-size: 13px; color: #4a4a4a">设计模式</a>
                  </div>
                </div>
      </div>
    </div>
  </div>
</body>

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WJ7P5KL" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  

</html>
<script type="text/javascript">
  window.THEME_CONFIG = JSON.parse('{"title":"Hexo","subtitle":null,"description":null,"author":"shanshan","language":"en","timezone":null,"url":"https://piggyzss.github.io","root":"/","permalink":":year/:month/:day/:title/","permalink_defaults":null,"source_dir":"source","public_dir":"public","tag_dir":"tags","archive_dir":"archives","category_dir":"categories","code_dir":"downloads/code","i18n_dir":":lang","skip_render":null,"new_post_name":":title.md","default_layout":"post","titlecase":false,"external_link":true,"filename_case":0,"render_drafts":false,"post_asset_folder":true,"relative_link":false,"future":true,"highlight":{"enable":false,"auto_detect":false,"line_number":true,"tab_replace":null},"default_category":"uncategorized","category_map":null,"tag_map":null,"date_format":"YYYY-MM-DD","time_format":"HH:mm:ss","per_page":10,"pagination_dir":"page","theme":"hexo-theme-huhu","deploy":{"type":"git","repository":"https://github.com/piggyzss/piggyzss.github.io.git","branch":"master"},"ignore":[],"keywords":null,"highlight_theme":"normal","index_generator":{"per_page":10,"order_by":"-date","path":""},"gitment":{"enable":true,"mint":true,"count":true,"lazy":false,"cleanly":false,"language":null,"github_user":"piggyzss","github_repo":"piggyzss.github.io/","client_id":"09a2760e2209a8728279","client_secret":"1162d7e456f9c8d3f15f164e63f5d253679445a5","proxy_gateway":null,"redirect_protocol":null},"archive_generator":{"per_page":10,"yearly":true,"monthly":true,"daily":false},"category_generator":{"per_page":10},"tag_generator":{"per_page":10},"marked":{"gfm":true,"pedantic":false,"breaks":true,"smartLists":true,"smartypants":true,"modifyAnchors":"","autolink":true,"sanitizeUrl":false,"headerIds":true},"server":{"port":4000,"log":false,"compress":false,"header":true},"menu":{"home":"/","archives":"/archives","about":"/about","music":"/music","gallery":"/gallery"},"logo":"/images/logo.png","categories_max":5,"tags_max":10,"favicon":"/images/favicon.ico","site_search":true,"rss":"/atom.xml","follow":{"github":"https://github.com/piggyzss","instagram":"https://www.instagram.com/doudou_lucky7/","weibo":""},"search_url":"/search.xml","site_icp":"","site_friends":{"房间里的小猫咪":"http://baidu.com"},"changyan":{"appid":"","conf":""},"valine":{"API_ID":"FjXColpwTL0BsrjJIN8Pmnn0-gzGzoHsz","API_KEY":"Ar7tucPRn3KV7UOidQxESoys"},"share":["weibo","weixin","qqkongjian","QQ","douban","facebook","twitter","google"],"cdn_module":{"av_min":"https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min","jquery":"https://cdn.bootcss.com/jquery/3.4.1/jquery.min","busuanzi":"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini","confirm":"https://cdn.bootcss.com/jquery-confirm/3.3.4/jquery-confirm.min","fancybox":"https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min"},"google_site_verification":"VQowHv5lAVVWJxjKI9bnAWT7NGdOrfS5KnLF07-B7w0","gtm_id":"GTM-WJ7P5KL","baidu_push":true,"reward":{"weixin":"images/weixin.png","zhifubao":"images/zhifubao.png"},"disqus":{"shortname":"shanshan"},"post":{"date_format":"dddd, MMMM Do YYYY, h:mm a","comments":{"enable":true,"type":"disqus"}}}')
  window.loadJs = function (d, m, a) {
    var c = document.getElementsByTagName('head')[0] || document.head || document.documentElement
    var b = document.createElement('script')
    b.defer = true
    b.setAttribute('type', 'text/javascript')
    b.setAttribute('charset', 'UTF-8')
    b.setAttribute('async', 'true')
    b.setAttribute('src', d)
    m && b.setAttribute('data-main', '/scripts/app')
    if (typeof a === 'function') {
      if (window.attachEvent) {
        b.onreadystatechange = function () {
          var e = b.readyState
          if (e === 'loaded' || e === 'complete') {
            b.onreadystatechange = null
            a()
          }
        }
      } else {
        b.onload = a
      }
    }
    c.appendChild(b)
  }
  loadJs('https://cdn.bootcss.com/require.js/2.3.6/require.min.js', true, function () {
    require.config({
      paths: {
        // site
        share: 'share',
        iconfont: 'iconfont',
        hodgepodge: 'hodgepodge',
        valine: ['cdn/Valine.min'],

        // cdn
        av: ['https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min', 'cdn/av-min'],
        jquery: ['https://cdn.bootcss.com/jquery/3.4.1/jquery.min', 'cdn/jquery.min'],
        busuanzi: ['//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini', 'cdn/busuanzi.pure.mini'],
        confirm: ['https://cdn.bootcss.com/jquery-confirm/3.3.4/jquery-confirm.min', 'cdn/jquery.confirm.min'],
        fancybox: ['https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min', 'cdn/jquery.fancybox.min']
      },

      map: {
        '*': {
          // css: '/scripts/cdn/css-min.js'
          css: 'https://cdn.bootcss.com/require-css/0.1.10/css.min.js'
        }
      },

      shim: {
        fancybox: {
          // deps: ['css!../style/fancybox']
          deps: ['css!https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.css']
        },
        confirm: {
          // deps: ['css!../style/confirm']
          deps: ['css!https://cdn.bootcss.com/jquery-confirm/3.3.4/jquery-confirm.min.css']
        }
      },

      // 加载超时
      waitSeconds: 3
    })
  })
</script>

  <script>
      ; (function () {
        var bp = document.createElement('script')
        var curProtocol = window.location.protocol.split(':')[0]
        if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js'
        } else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js'
        }
        var s = document.getElementsByTagName('script')[0]
        s.parentNode.insertBefore(bp, s)
      })()
  </script>
  